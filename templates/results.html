{% extends "base.html" %}
{% block extra_css %}
    <link href="{{ url_for('static', filename='css/results.css') }}" rel="stylesheet">
{% endblock %}
{% block title %}Results{% endblock %}
{% block content %}
    <section class="results">
    <h1>Results</h1>
    <div class="filters"></div>
    {% if response %}
        <section class="list-view">
        {% for item in response.hits %}
            {% for node in item.nodes %}
                {% if node.type == 'atom' %}
                <div class="result-card">
                    <div class="result-content">
                        <h4><b>{{ node.text|striptags|truncate(50, True) }}</b></h4>
                        <p>{{ node.text }}</p>
                    </div>
                    <div class="result-bottom">
                        <div class="result-content">
                            <a href="{{ url_for('graph', id=node.id) }}" title="Go to Argument Map"><i class="fa fa-sitemap"></i></a>
                            <span class="date">{{ node.metadata.aif_json.timestamp }}</span>
                        </div>
                    </div>
                </div>
                {% endif %}
                {% endfor %}
        {% endfor %}
        </section>
        <section class="pro-con-view hidden">
            <div class="lists">
                <div class="list">
                    <h2 class="pro-heading">Pro</h2>
                    {% for node in supporting_arguments %}
                    <div class="result-card">
                        <div class="result-content">
                            <h4><b>{{ node.text|striptags|truncate(50, True) }}</b></h4>
                            <p>{{ node.text }}</p>
                        </div>
                        <div class="result-bottom">
                            <div class="result-content">
                                <a href="{{ url_for('graph', id=node.id) }}" title="Go to Argument Map"><i class="fa fa-sitemap"></i></a>
                                <span class="date">{{ node.metadata.aif_json.timestamp }}</span>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
            <div class="list">
            <h2 class="con-heading">Con</h2>
                {% for node in conflicting_arguments %}
                <div class="result-card">
                    <div class="result-content">
                        <h4><b>{{ node.text|striptags|truncate(50, True) }}</b></h4>
                        <p>{{ node.text }}</p>
                    </div>
                    <div class="result-bottom">
                        <div class="result-content">
                            <a href="{{ url_for('graph', id=node.id) }}" title="Go to Argument Map"><i class="fa fa-sitemap"></i></a>
                            <span class="date">{{ node.metadata.aif_json.timestamp }}</span>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
          </div>
        </section>
    {% endif %}
    </section>
{% endblock %}
{% block extra_js %}
    <script>
    let tabs = document.querySelectorAll('.panel-bar button');
    tabs.forEach(tab => {
        tab.addEventListener('click', function (){
            tabs.forEach(tab => tab.classList.remove("active"));
            tab.classList.add("active");
        });
    });
    function showTab(tab){
        if(tab === 'list'){
            document.querySelector('.list-view').classList.remove('hidden');
            document.querySelector('.pro-con-view').classList.add('hidden');
        }
        if(tab === 'pro-con'){
            document.querySelector('.pro-con-view').classList.remove('hidden');
            document.querySelector('.list-view').classList.add('hidden');
        }
    }
    </script>
{% endblock %}